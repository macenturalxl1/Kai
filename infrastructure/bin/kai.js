"use strict";
/*
 * Copyright 2020 Crown Copyright
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("@aws-cdk/core");
const app_stack_1 = require("../lib/app-stack");
// App
const app = new cdk.App();
// Environment
const dev = {
    account: process.env.CDK_DEFAULT_ACCOUNT,
    region: process.env.CDK_DEFAULT_REGION
};
// Main Stack
new app_stack_1.AppStack(app, "KaiStack", {
    env: dev,
    stackName: "KaiStack"
});
// Tags
let tags = app.node.tryGetContext("globalTags");
// CDK does not support json parsing when using the --context option so we must parse it ourselves here
if (tags != null) {
    if (typeof tags == "string") {
        tags = JSON.parse(tags);
    }
    for (const [key, value] of Object.entries(tags)) {
        cdk.Tag.add(app, key, value);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia2FpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsia2FpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7Ozs7R0FjRzs7QUFFSCxxQ0FBcUM7QUFDckMsZ0RBQTRDO0FBRTVDLE1BQU07QUFDTixNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUUxQixjQUFjO0FBQ2QsTUFBTSxHQUFHLEdBQUc7SUFDUixPQUFPLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUI7SUFDeEMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0JBQWtCO0NBQ3pDLENBQUM7QUFFRixhQUFhO0FBQ2IsSUFBSSxvQkFBUSxDQUFDLEdBQUcsRUFBRSxVQUFVLEVBQUU7SUFDMUIsR0FBRyxFQUFFLEdBQUc7SUFDUixTQUFTLEVBQUUsVUFBVTtDQUN4QixDQUFDLENBQUM7QUFFSCxPQUFPO0FBQ1AsSUFBSSxJQUFJLEdBQXdCLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3JFLHVHQUF1RztBQUN2RyxJQUFJLElBQUksSUFBSSxJQUFJLEVBQUU7SUFDZCxJQUFJLE9BQU8sSUFBSSxJQUFJLFFBQVEsRUFBRTtRQUN6QixJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUMzQjtJQUVELEtBQUssTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQzdDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDaEM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAyMCBDcm93biBDb3B5cmlnaHRcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0ICogYXMgY2RrIGZyb20gXCJAYXdzLWNkay9jb3JlXCI7XG5pbXBvcnQgeyBBcHBTdGFjayB9IGZyb20gXCIuLi9saWIvYXBwLXN0YWNrXCI7XG5cbi8vIEFwcFxuY29uc3QgYXBwID0gbmV3IGNkay5BcHAoKTtcblxuLy8gRW52aXJvbm1lbnRcbmNvbnN0IGRldiA9IHsgXG4gICAgYWNjb3VudDogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfQUNDT1VOVCwgXG4gICAgcmVnaW9uOiBwcm9jZXNzLmVudi5DREtfREVGQVVMVF9SRUdJT04gXG59O1xuXG4vLyBNYWluIFN0YWNrXG5uZXcgQXBwU3RhY2soYXBwLCBcIkthaVN0YWNrXCIsIHtcbiAgICBlbnY6IGRldixcbiAgICBzdGFja05hbWU6IFwiS2FpU3RhY2tcIlxufSk7XG5cbi8vIFRhZ3NcbmxldCB0YWdzOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gYXBwLm5vZGUudHJ5R2V0Q29udGV4dChcImdsb2JhbFRhZ3NcIik7XG4vLyBDREsgZG9lcyBub3Qgc3VwcG9ydCBqc29uIHBhcnNpbmcgd2hlbiB1c2luZyB0aGUgLS1jb250ZXh0IG9wdGlvbiBzbyB3ZSBtdXN0IHBhcnNlIGl0IG91cnNlbHZlcyBoZXJlXG5pZiAodGFncyAhPSBudWxsKSB7XG4gICAgaWYgKHR5cGVvZiB0YWdzID09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdGFncyA9IEpTT04ucGFyc2UodGFncyk7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGFncykpIHtcbiAgICAgICAgY2RrLlRhZy5hZGQoYXBwLCBrZXksIHZhbHVlKTtcbiAgICB9XG59ICAgICAgICAgICBcblxuIl19